#+title: ECE382 - Control Systems - Spring 2016

* Poles and Zeros
** Open loop

** Closed loop

#+attr_html: width 400
[[./loop.png]]

$T(s) = \frac{C(s)}{R(s)} = \frac{G(s)}{1 + G(s)H(s)}$

roots of $G(s)$: closed loop zeros

roots of $1 + G(s)$: closed loop poles

$\frac{B}{E} = G(s)H(s)$

roots of $G(s)H(s)$: zeros

poles of $G(s)H(s)$: poles

* Characteristic Equation

#+begin_definition
Characteristic equation - $1 + G(s)H(s) = 1 + \frac{N_1N_2}{D_1D_2} = \frac{D_1D_2 + N_1N_2}{D_1D_2}$
#+end_definition

$D_1D_2 + N_1N_2$: closed-loop poles

$D_1D_2$: open-loop poles

transfer functions need to be in polynomial form
#+begin_examples
1. $G_2(s) = \frac{1}{s-1}$

   $s = +1 \Rightarrow e^t$, so system is unstable
#+end_examples

* Second-order systems
** Characterization
*second-order transfer function* - \[T(s) = \frac{N}{N + D} = \frac{w_n^2}{s^2 + 2\zeta w_ns + w_n^2}\]

$\zeta = \cos (\theta)$: damping coefficient

$w_n$: undamped natural frequency

$w_d = w_n \sqrt{1 - \zeta^2}$ - damped frequency

$\zeta \omega_n$: attenuation

use quadratic formula to find poles

\begin{equation*}
s_1,s_2 =
  \begin{cases}
    -\zeta w_n +- w_n \sqrt{\zeta^2 -1} & \zeta \geq 0 \\ 
    -\zeta w_n +- w_n \sqrt{1 - \zeta^2} & 0 < \zeta < 1
  \end{cases}
\end{equation*}


[[./damping.png]]

Four cases:
1. $\zeta = 0$: infinite signal
2. $\zeta = 1$: critically-damped$
3. $0 < \zeta < 1$ - infinite oscillations
4. $\zeta > 1$ - overdamped 

* Routh-Hurwitz Stability Test
1. Construct first two rows
2. Construct next rows based on first two
3. Count number of sign changes in first column to find RHP poles

Let $Q(s) = a_ns^n + a_{n-1}s^{n-1} + ... + a_1s + a_0 = 0$

If $n$ is even

| $s^n$     | $a_n$     | $a_{n-2}$ | ... | $a_0$ |
| $s^{n-1}$ | $a_{n-1}$ | $a_{n-3}$ | ... | $a_1$ |

If $n$ is odd

| $s^n$     | $a_n$     | $a_{n-2}$ | ... | $a_0$ |
| $s^{n-1}$ | $a_{n-1}$ | $a_{n-3}$ | ... | $a_1$ |

Construct rest of table

| $s^{n-2}$   | $b_1$ | $b_2$ | ... | $b_{n+1}$ |
| $s^{n-3}$ | $c_1$ | $c_2$ | ... | $c_{n+1}$ |
| $s^{n-4}$ | $d_1$ | $d_2$ | ... | $d_{n+1}$ |

Where 
$$ \begin{aligned}
b_1 & = \frac{a_{n_1}a_{n-2} - a_na_{n-3}}{a_{n-1}} \\
b_2 & = \frac{a_{n_1}a_{n-2} - a_na_{n-4}}{a_{n-2}} \\
...
\end{aligned} $$

If $b_n$ is zero, use $\varepsilon$ as a placeholder for a positive number.
Assume blank entries to be 0.

If a row is zero, differentiate the row above it and replace the zeros with the coefficients.

The number of sign changes in the first column is equal to
the number of poles in RHP.

If the rows above and below $\varepsilon$ have the same sign,
then the poles are on the imaginary axis.

If the rows above and below $\varepsilon$ have the same sign,
then the poles are on the real axis.

#+begin_examples
1. Let $Q(s) = s(s+1)(s+2) + 3 = s^3 + 3s^2 + 2s + 7 = 0$
   | $s^3$ |               1 |   2 |
   | $s^2$ |               3 |   7 |
   | $s$   | $\frac{-1}{3}$  | nan |
   | $s^0$ |               7 | nan |
   
   Two sign changes means two RHP poles, 1 LHP pole, so the system is unstable.

2. Let $Q(s) = s^3 + 4s^2 + s - 6$
   | $s^3$ |              1 |  1 |
   | $s^2$ |              4 | -6 |
   | $s^1$ | $\frac{10}{4}$ |    |
   | $s^0$ |             -6 |    |

    One sign change means one RHP pole, 2 LHP poles, so the system is unstable.

3. Let $Q(s) = s^3 - s^2 - s + 1 = 0$
   | $s^3$ |             1 | -1 |
   | $s^2$ |            -1 |  1 |
   | $s^1$ | $\varepsilon$ |    |
   | $s^0$ |             1 |    |
#+end_examples

#+begin_examples
1. $G(s) = \frac{k}{s(s+1)(s+2)}$
   $k_p = \lim_{s \to 0} G(s) = \infty$
   $k_v = \lim_{s \to 0} s G(s) = \frac{k}{2}$
   $e_{ss} = \frac{3}{1 + k_p} + \frac{2}{k_v} = \frac{4}{k}$
   $Q(s) = s(s+1)(s+2) + K = s^3 + 3s^2 + 2s + K$
   | $s^3$ | $1$             | $2$ |
   | $s^2$ | $3$             | $K$ |
   | $s^1$ | $\frac{6-K}{3}$ |     |
   | $s^0$ | $0$             |     |
2. $T(s) = \frac{G}{1+G} = \frac{k}{s^2 +2s + K}$

   $Q(s) = \frac{s^2 + 2s + K}{s(s+2)}$

   $Q(s) = s^2 + 2s + K$

   | $s^2$ | 1    | K |
   | $s^1$ | $2$  |   |
   | $s^0$ | $2K$ |   |
   
   System is stable for all $K > 0$

   $s_1,s_2 = \frac{-2 +- \sqrt{4 - 4K}}{2} = -1 += \sqrt{1-K}$

   Let $K=0$, then $s_1,s_2 = 0, -2$

   Let $K=.5$, then $s_1,s_2 = -0.29, -1.707$

   Overdamped

   Let $K=1$, then $s_1,s_2 = -1, 1$

   Critically damped

   Let $K=2$, then $s_1,s_2 = -1+j, 1+j$

   Underdamped
   
   [[./root_locus.png]]
#+end_examples
* Root Locus
Let $F(s)$ be some complex function and $s_1$ be some complex point.

Then \[|F(s)| = \frac{|s_1 + z_1|...|s_1 + z_n|}{|s_1 + p_1|...|s_1 + p_n|}\]

and \[\angle F(s) = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1)\]

** Finding closed loop poles
With the characteristic equation, we can find all the poles of the closed-loop transfer function and determine stability.

The zeroes of the characteristic equation are the poles of the closed-loop transfer function.

Note that we factor $K$ out of $G(s)H(s)$ since the gain is trivial to adjust in most systems.

\[Q(s) = 1 + KG(s)H(s) = 1 + \frac{K (s + Z_1) ... (s + Z_n)}{(s + P_1) ... (s + P_n)}\]

\[KG(s)H(s) = \frac{K (s + Z_1) ... (s + Z_n)}{(s + P_1) ... (s + P_n)} = -1 + j0\]

So \[\frac{K |s + Z_1| ... |s + Z_n|}{|s + P_1| ... |s + P_n|} = 1\]

and \[\sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) = \pi(1 + 2n), n = 0,1,2,...\]

When testing specific points, it is generally easier to start by checking the angle first.

#+begin_examples
1. Given $G(s)H(s) = \frac{s+1}{s+3}$, check if $s_1 = 2 + j3$ is a pole of the closed-loop transfer function 
   
   [[./rootlocus1.png]]

   $\theta_1 - \phi_1 = \tan^{-1} (\frac{3}{3}) \tan^{-1} (\frac{3}{5}) \approx 14^{\circ}$

   Characteristic equation: $1 + KG(s)H(s) = 0$

   So $s_1$ is not a pole.
#+end_examples
** Constructing root locus
Rules
1. root locus has 1 branch for every pole of the characteristic equation (zero of closed loop)
2. branches start at poles and ends at zeros
3. root locus is defined for areas on the real axis where the number of poles and zeros to the right is odd
4. the asymptotes of the zeros at infinity have the angle $$\phi_i = \frac{180^\circ (1 + 2 q)}{N_p - N_i}, i = 0, 1, 2, ..., (N_p - N_z -1)$$ where $N_p,N_z$ are number of poles, zeros
5. centroid: $\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z}$
6. branches intersect the real axis where K is at a local min/max ($\frac{dK}{ds} = 0$)  (breakaway point)
7. angle of departure from a pole: $\phi_p = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) - \pi$
   #+begin_derivation
   \[\angle G(s)H(s)|_{s=s_1} = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles (except s_1) \rightarrow s_1) - \phi_p = \pi\]

   $\phi_p = \sum \angle (zeros \rightarrow s_1) - \sum \angle (poles \rightarrow s_1) - \pi$
   #+end_derivation
8. Routh-Hurwitz

#+begin_examples
1. Let $G(s)H(s) = \frac{K}{s (s + 1) (s + 2)}$

   $N_p = 3, N_z = 0$

   From rule 3, the locus is defined on the real axis for $(-\infty, -2) \cup (-1, 0)$

   From rule 5, The *centroid* is located at $\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z} = \frac{-1 + 2 + 0}{3} = -1$

   From rule 4, the *asymptotes* of the branches at $K = \infty$ from the centroid are $\phi_i = \frac{180^\circ (1 + 2 q)}{N_p - N_i}, (q = 0,1,2) = 60^\circ, 180^\circ, 300^\circ$

   *Breakaway point*: $1 + KG(s)H(s) = 0 \rightarrow K = \frac{-1}{G(s)H(s)}$

   \[\frac{d}{ds} [\frac{1}{s (s + 1) (s + 2)}] = \frac{-(1) (3s^2 + 6s + 2)}{[s (s + 1) (s + 2)]^2} = 0\]

   so  $s_1,s_2 = \frac{-6 \pm \sqrt{36 - 24}}{6} \approx -0.42, -1.58$

   but $-1.58$ is not defined on the real axis, so it is thrown away

   *Imaginary exis intersection*

   | $s^3$ |               1 |   2 |
   | $s^2$ |               3 | $K$ |
   | $s^1$ | $\frac{6-K}{3}$ |     |
   | $s^0$ |               K |     |

   So the poles are on the imaginary exis when $K=6$
   [[./rootlocus_example.png]]

2. Let $G(s) = \frac{K}{s(s+1)}$

   $\sigma_A = \frac{\sum Re(p_i) - \sum Re(z_i)}{N_p - N_z} = \frac{-1}{2}$

   *Breakaway point*

   \[\frac{d}{ds} [G(s)] = 0\]
   
   $s = \frac{-1}{2}$

   ipe
   -1     0
    x     x

   [[./rootlocus_example2.png]]

3. Let $G(s) = \frac{k(s^2 + 2s + 2)}{s(s-2)}$

   Poles are located at $s_1,s_2 = \frac{-2 \pm \sqrt{4 - 8}}{2} = -1 \pm j$

   $N_p,N_z = 2$, so no asymptotes

   *Breakaway point*

   \[\frac{dK}{ds} = \frac{d}{ds} G(s) = \frac{(s^2 - 2s)(2s + 2) - (s^2 + 2s+ 2)(2s - 2)}{(s(s - 2))^2 =  0\]  

   so $s_1,s_2 = 0.618, -1.68$

   but $0.618$ is not defined on the real axis, so it is thrown away

   *Angle of arrival*

   $\phi_z = \pi + \sum \angle \text{poles} - \sum \angle \text{zeros} = \pi + (\pi - \tan^{-1}\frac{1}{3}) + (\pi - \tan^{-1}\frac{1}{1}) - \frac{\pi}{2} = 26.57^{\circ}$

   *Imaginary Axis Interseciton*

   | $s^2$ | $1 + K$ | $2K |
   | $s^1$ | $2K-2$  |     |
   | $s^0$ | $2K$    |     | 

   So no sign change occurs when $K \geq 1$

   [[./rootlocus_example3.png]]

4. If $K = 4$, plot RL for $P > 0$

   $Q(s) = 1 + G(s) = 1 + \frac{4}{s(s+p)} = 0$
#+end_examples
